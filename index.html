<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Volunteer Tasks</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    input, select, textarea { margin: 5px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 10px; }
  </style>
</head>
<body>
  <h2>Enter your email to view your tasks</h2>
  <input type="email" id="email" placeholder="you@example.com">
  <button onclick="loadTasks()">Load Tasks</button>

  <div id="tasks-container"></div>

  <script>
    async function loadTasks() {
      const email = document.getElementById("email").value;
      if (!email) return alert("Please enter your email");

      const res = await fetch("https://hook.eu2.make.com/3ck44is39dfmap58tr7w47mr21dpfdhl", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email })
      });

      const tasks = await res.json();
      showTasks(tasks);
    }

    function showTasks(tasks) {
      const container = document.getElementById("tasks-container");
      if (!tasks.length) {
        container.innerHTML = "<p>No tasks found.</p>";
        return;
      }

      let html = `<table><tr>
        <th>Title</th><th>Description</th><th>Status</th><th>Hours</th><th>Update</th>
      </tr>`;

      tasks.forEach(task => {
        html += `<tr>
          <td>${task["Task Title"]}</td>
          <td>${task["Task Description"]}</td>
          <td>
            <select id="status-${task["Task ID"]}">
              <option ${task["Task Status"] === "Not Started" ? "selected" : ""}>Not Started</option>
              <option ${task["Task Status"] === "In Progress" ? "selected" : ""}>In Progress</option>
              <option ${task["Task Status"] === "Completed" ? "selected" : ""}>Completed</option>
            </select>
          </td>
          <td><input type="number" id="hours-${task["Task ID"]}" value="${task["Hours Spent"] || 0}" step="0.1"></td>
          <td><button onclick="updateTask('${task["Task ID"]}')">Save</button></td>
        </tr>`;
      });

      html += "</table>";
      container.innerHTML = html;
    }

    async function updateTask(taskId) {
      const status = document.getElementById(`status-${taskId}`).value;
      const hours = parseFloat(document.getElementById(`hours-${taskId}`).value);

      await fetch("https://hook.eu2.make.com/mbm1q2ak4re8ri2fr75fxeddsfq6i71w", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          taskId,
          "Task Status": status,
          "Hours Spent": hours
        })
      });

      alert("Task updated!");
    }
  </script>
</body>
</html>
